@REM del mihomo.yaml
@REM mihomo.yaml https://github.com/anaer/Sub/blob/main/mihomo.yaml
@REM aria2c -d . --check-certificate=false --max-connection-per-server=10 --max-concurrent-downloads=20 --split=20 --min-split-size=1M --continue=true --optimize-concurrent-downloads=true --connect-timeout=5 --timeout=10 --lowest-speed-limit=5K --allow-overwrite=true --disk-cache=64M --max-tries=5 --retry-wait=5  https://github.boki.moe/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://git-yjs.jiongzu.cn/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://git.043.me/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://gh.samiya.pro/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://ghproxy.liki4.icu/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://fastgh.lainbo.com/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://cdn.jsdelivr.us/gh/anaer/Sub@main/mihomo.yaml https://raw.bunnyxyz.eu.org/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://cf.ghproxy.cc/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://jsd.cdn.zzko.cn/gh/anaer/Sub@main/mihomo.yaml https://jsd.onmicrosoft.cn/gh/anaer/Sub@main/mihomo.yaml https://hub.incept.pw/anaer/Sub/main/mihomo.yaml https://fastraw.ixnic.net/anaer/Sub/main/mihomo.yaml https://ghproxy.net/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://github.moeyy.xyz/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://mirror.ghproxy.com/https://raw.githubusercontent.com/anaer/Sub/main/mihomo.yaml https://fastly.jsdelivr.net/gh/anaer/Sub@main/mihomo.yaml https://gcore.jsdelivr.net/gh/anaer/Sub@main/mihomo.yaml https://testingcf.jsdelivr.net/gh/anaer/Sub@main/mihomo.yaml https://cdn.jsdelivr.net/gh/anaer/Sub@main/mihomo.yaml

@REM mihomo-windows-amd64.zip https://github.com/MetaCubeX/mihomo/releases
@REM aria2c -d . --check-certificate=false --max-connection-per-server=10 --max-concurrent-downloads=20 --split=20 --min-split-size=1M --continue=true --optimize-concurrent-downloads=true --connect-timeout=5 --timeout=10 --lowest-speed-limit=5K --allow-overwrite=true --disk-cache=64M --max-tries=5 --retry-wait=5  https://github.boki.moe/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://ghp.ci/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://git-yjs.jiongzu.cn/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://download.yzuu.cf/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://gh.mzec.top/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://gh.nxnow.top/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://ghproxy.cc/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://ghproxy.liuzhicong.com/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://ghproxy.net/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://git.814560.xyz/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://mirror.ghproxy.com/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://slink.ltd/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://gh.900110.xyz/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://git.988896.xyz/https://github.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://hub.whtrys.space/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://ghps.cc/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip https://kkgithub.com/MetaCubeX/mihomo/releases/download/v1.19.0/mihomo-windows-amd64-v1.19.0.zip

@REM geo-windows-amd64.exe https://github.com/MetaCubeX/geo/releases
@REM aria2c -d . --check-certificate=false --max-connection-per-server=10 --max-concurrent-downloads=20 --split=20 --min-split-size=1M --continue=true --optimize-concurrent-downloads=true --connect-timeout=5 --timeout=10 --lowest-speed-limit=5K --allow-overwrite=true --disk-cache=64M --max-tries=5 --retry-wait=5  https://hub.whtrys.space/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://git.988896.xyz/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://raw.bunnyxyz.eu.org/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://cf.ghproxy.cc/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://cors.isteed.cc/github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://dl.ghpig.top/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://download.nuaa.cf/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://download.scholar.rr.nu/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://download.yzuu.cf/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://gh.con.sh/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://gh.ddlc.top/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://gh.jiasu.in/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://gh.mixyun.cyou/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://gh.mzec.top/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://gh.nxnow.top/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://ghproxy.053000.xyz/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://ghproxy.cc/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://ghproxy.liuzhicong.com/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://ghproxy.net/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://git.814560.xyz/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://git.domob.org/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://hub.gitmirror.com/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://mirror.ghproxy.com/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://sciproxy.com/github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://slink.ltd/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://ghps.cc/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://521github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe https://gh.900110.xyz/https://github.com/MetaCubeX/geo/releases/download/v1.1/geo-windows-amd64.exe

@REM WinSW-x64.exe https://github.com/winsw/winsw/releases
@REM aria2c -d . -o mihomo-server.exe --check-certificate=false --max-connection-per-server=10 --max-concurrent-downloads=20 --split=20 --min-split-size=1M --continue=true --optimize-concurrent-downloads=true --connect-timeout=5 --timeout=10 --lowest-speed-limit=5K --allow-overwrite=true --disk-cache=64M --max-tries=5 --retry-wait=5  https://gh.labx.me/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://git-yjs.jiongzu.cn/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://git.043.me/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://gh.samiya.pro/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://ghproxy.liki4.icu/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://fastgh.lainbo.com/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://mirrors.chenby.cn/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://raw.bunnyxyz.eu.org/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe https://cf.ghproxy.cc/https://github.com/winsw/winsw/releases/download/v2.12.0/WinSW-x64.exe

netstat -aon | findstr "9090" > nul
if %errorlevel% equ 0 (
curl "http://127.0.0.1:9090/configs?force=true" ^
  -X "PUT" ^
  -H "Content-Type: application/json" ^
  -H "Authorization: Bearer 666999" ^
  --data-raw ^"^{^\^"path^\^": ^\^"^\^", ^\^"payload^\^": ^\^"^\^"^}^"

  echo "UPDATE CONFIG SUCCESS"

  if not exist "ui" (
  echo "ui directory not exist, trigger upgrade ui"
  curl "http://127.0.0.1:9090/upgrade/ui" ^
   -X "POST" ^
   -H "Authorization: Bearer 666999"
  )
)

pause